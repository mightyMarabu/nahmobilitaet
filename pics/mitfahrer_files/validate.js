define("ep/ui/validate",["jquery","ep","ep/dict","ep/validate","ep/ui/input","util/browser"],function(e,t){return e.widget("ui.uiValidate",e.ui.uiInput,{options:{valid:!0,type:"basic",showError:!0,showErrorMsgAlways:!1,validateOnSave:!1},_create:function(){var t=this,a=t.element,i=t.options,o="validate.uiValidate"+(i.validateOnSave?"":" blur.uiValidate");this._superApply(arguments),this.options=e.extend({accept:this.elem.attr("accept"),min:parseInt(this.elem.attr("min"),10),max:parseInt(this.elem.attr("max"),10),minlength:parseInt(this.elem.attr("minlength"),10),maxlength:parseInt(this.elem.attr("maxlength"),10),pattern:this.elem.attr("pattern"),required:this.elem.attr("required")},this.options),this.elem.addClass("ep-uiValidate").on(o,e.proxy(this,"_validate")),i.validateOnSave&&e.browser.mozilla&&(a.off("focusin.uiInput"),a.one("focusin.uiInput",e.proxy(t._handleFocus,t,{widget:t}))),t.clicked=!1,/(^(select:)|(checkbox)$)/.test(t.type)&&a.on("click.uiValidateClick",function(){t.clicked=!0}),this.options.valid||(this._setInstantly(),this._setValidStatus(!1))},_handleFocus:function(a){var i=a.widget,o=i.element;i._setValidStatus(!0),o.trigger("change"),t(o[0].form).trigger("change"),window.setTimeout(function(){o.one("focusin.uiInput",e.proxy(i._handleFocus,i,{widget:i}))},10)},_init:function(){this._superApply(arguments)},_setInstantly:function(){this._instantly=!0,this.elem.on("changeValue.uiValidate",e.proxy(this,"_validate"))},_radioGroupCheck:function(){this.elem.formGroup(":radio").trigger("validate")},_changeAttr:function(t,a){var i=this;this._superApply(arguments),e.each(a,function(e,t){/^(accept|pattern|required)$/i.test(e)?i.options[e]=t:/^(min|max|minlength|maxlength)$/i.test(e)&&(i.options[e]=parseInt(t,10))})},_setOption:function(e,t){return"valid"==e&&void 0!==t&&this._setValidStatus(t),this._superApply(arguments)},_setValidStatus:function(e){var a=this,i=a.element,o=a.options;a.valid=e===!1?t.validate.basic(""):e,o.setManually&&(a.valid=e),e=e!==!0,a.elem[0].formInvalid=e,a.placeholder&&(a.placeholder[0].formInvalid=e),a.options.showError&&(a.elem.toggleClass("ui-invalid",e),/(^(select:)|(checkbox)$)/.test(a.type)&&a.clicked&&i.trigger("focus"),a._tooltipShow()),a.clicked=!1},_validate:function(a){if(9!==a.keyCode){var i,o=this.elem.val(),n=this,l=n.options;this.elem.is(":radio")?o=this.elem.formGroup(":radio").filter(":checked").val()||"":this.elem.is(":checkbox")&&(o=this.elem.filter(":checked").val()||""),i=t.validate[this.options.type](o,this.options),l.setManually&&(i=n.element.data(l.setManually)),i===!0||this._instantly||this._setInstantly(),n.hideOnError=i===!0?void 0:!0,this._setValidStatus(i),"changeAttr"!==a.type&&e(this.elem[0].form).trigger("change")}},_createErrorMsgOptions:function(){var t={min:this.options.min,max:this.options.max,minlength:this.options.minlength,maxlength:this.options.maxlength},a=this.options.format,i={region:this.options.region};return"number"===this.options.type?(i.currency=this.options.currency,t.example=e.i18n.formatNumber(21.45923,a,i),(t.min||t.max)&&(t.min=e.i18n.formatNumber(t.min,a,i),t.max=e.i18n.formatNumber(t.max,a,i))):"date"===this.options.type&&(t.example=e.i18n.formatDate(new Date,a,i),(t.min||t.max)&&(t.min=e.i18n.formatDate(new Date(t.min),a,i),t.max=e.i18n.formatDate(new Date(t.max),a,i))),t},_tooltipShow:function(){var t=this,a=t.options;if(this.valid!==!0){this.tooltip||(this._tooltipInit(!0),this.tooltip.on("show",e.proxy(this,"_tooltipHide"))),this.errormsg||(this.errormsg=e("<div>").addClass("ep-uiValidate-message").insertBefore(this.tooltip),this.stack.push(this.errormsg[0])),t.tooltip.uiTooltip("adjustTooltipByWidth",this.elem,this.errormsg);var i=this._createErrorMsgOptions();this.errormsg.text(a.customMessage?a.customMessage:this.dict.translateData(this.valid,i)),this.errormsg.show(),(this.elem.is(":focus")||this.options.showErrorMsgAlways)&&this.tooltip.uiTooltip("show"),this.tooltip.hide()}else this._tooltipHide()},_tooltipHide:function(){var e=this,t=function(){e.errormsg&&e.errormsg.hide()};this.tooltip&&this.valid===!0&&(this.options.info?t():this.tooltip.uiTooltip("hide",t))},destroy:function(){this.elem.off(".uiValidate").removeClass(/ep-uiValidate[\w\d-]*/g),this._superApply(arguments)}}),t});
//@ sourceMappingURL=validate.js.map