define("$tmpl!de_epages/remotesearch/ui/suggest",["jquery/tmpl"],function(e){e.template("de_epages.remotesearch.ui.suggest",'<ul>{{if list.length}}{{each(i,obj) list}}{{if i<o.suggestMax}}{{if $item.separator(obj.type)}}<li class="Separator">${dict[obj.type]}:</li>{{/if}}{{if obj.type == \'products\'}}<li class="${obj.type}" data-index="${i}">{{if o.showImages && obj.image}}<img src="${obj.image}"/>{{/if}}{{html $item.highlight(obj.name)}}</li>{{else}}<li class="${obj.type}" data-index="${i}">{{html $item.highlight(obj.name)}}{{if obj.matches}} <span class="suggestMatches">(${obj.matches})</span>{{/if}}</li>{{/if}}{{/if}}{{/each}}{{else}}<li class="searchfor" data-index="0">${dict.searchfor}: ${query}</li>{{/if}}</ul>');var t=e.template("de_epages/remotesearch/ui/suggest",'<ul>{{if list.length}}{{each(i,obj) list}}{{if i<o.suggestMax}}{{if $item.separator(obj.type)}}<li class="Separator">${dict[obj.type]}:</li>{{/if}}{{if obj.type == \'products\'}}<li class="${obj.type}" data-index="${i}">{{if o.showImages && obj.image}}<img src="${obj.image}"/>{{/if}}{{html $item.highlight(obj.name)}}</li>{{else}}<li class="${obj.type}" data-index="${i}">{{html $item.highlight(obj.name)}}{{if obj.matches}} <span class="suggestMatches">(${obj.matches})</span>{{/if}}</li>{{/if}}{{/if}}{{/each}}{{else}}<li class="searchfor" data-index="0">${dict.searchfor}: ${query}</li>{{/if}}</ul>');return function(i,n){return e.tmpl(t,i,n)}}),define("de_epages/remotesearch/ui/suggest",["jquery","ep","de_epages","util/string","$dict!../dictionary","$tmpl!./suggest","jquery/ui/widget","ep/fn/contextorientation","ep/ui/validate"],function(e,t,i,n,o,a){var s={products:o.translate("Products"),categories:o.translate("Categories"),manufacturers:o.translate("Manufacturers"),searchfor:o.translate("SearchFor")};return e.widget("ui.remotesearchUiSuggest",e.ui.uiValidate,{options:{suggestChars:1,suggestMax:10,showImages:!0},_create:function(){this._superApply(arguments);var t=this,i=t.options;t.filter=i.filter?e(i.searchFilter):e('<input type="hidden"/>').insertAfter(t.elem),t.elem.attr("autocomplete","off").on("keydown",e.proxy(t,"_keydown")).on("keyup",e.proxy(t,"_keyup")).on("focus",e.proxy(t,"_show")).on("blur",e.proxy(t,"_hide")),t.list=e('<div class="de_epages-remotesearchUiSuggest-box"/>').on("mouseenter","li",function(){e(this).addClass("ui-hover")}).on("mouseleave","li",function(){e(this).removeClass("ui-hover")}).on("mousedown","li:not(.Separator)",function(i){t._select(e(this).data("index")),t._action(i),setTimeout(function(){t.elem.trigger("focus")},1)}),t.cache={},t.dataModels={},t.selectedIndex=-1,t.xhr={abort:e.noop},t.xhrSettings={type:"get",dataType:"jsonp",data:{}},i.suggestUrl&&(t.xhrSettings.url=i.suggestUrl)},_keydown:function(e){var t=e.keyCode||e.which;38==t||40==t?e.preventDefault():13==t&&this._action(e)},_keyup:function(t){var i=this,n=t.keyCode||t.which,o=i.elem.val();if(i.options,9!=n&&13!=n&&37!=n&&39!=n&&32!=n)if(38==n)i._select("prev");else if(40==n)i._select("next");else if(o.length<i.options.suggestChars)i._clear();else if(i.cache[o])i._build();else{if(i.lastAjaxFail){if((new Date).getTime()-i.lastAjaxFail<6e4)return;i.lastAjaxFail=null}e.ajax(e.extend(!0,{data:{q:o}},i.xhrSettings)).done(function(t){e.extend(i.cache[o]||(i.cache[o]={}),t),i._build()}).fail(function(){i.lastAjaxFail=(new Date).getTime()})}},_hide:function(){this.list.hide()},_show:function(){this.list.find("li").length&&this.list.show()},_clear:function(){this.list.empty(),this._hide()},_dataModel:function(t){var i,n=this,o=n.dataModels[t];return o||(i=n.cache[t],o={query:t,list:[],dict:s},i&&(e.each(["products","manufacturers","categories"],function(t,n){i[n]=e.each(i[n]||[],function(){this.type=n}),o.list=o.list.concat(i[n])}),n.dataModels[t]=o)),o.o=n.options,o},_build:function(){var t=this,i=t.elem.val(),o=t.dataModel=t._dataModel(i),s=new RegExp("("+n.escExpStr(i)+")","ig");t._clear(),t.list.appendTo("body").contextOrientation(t.elem,"bottom").append(a([o],{highlight:function(e){return e.replace(s,"<strong>$1</strong>")},separatorLast:"",separator:function(e){return this.separatorLast==e?!1:!!(this.separatorLast=e)}}));var r=t.list.width(),l=t.elem.parent().innerWidth();l>r&&t.list.width(l),t.options.navbar&&t.list.addClass(t.options.navbar),t._select(-1),t._show(),e(document).trigger("suggestsearch:build",{list:t.list,elem:t.elem})},_select:function(t){var i=this,n=i.selectedIndex,o=i.list.find("li:not(.Separator)");i.filterData={},"next"==t?n++:"prev"==t?n--:n=t,n>=o.length?n=-1:-1>n&&(n=o.length-1),o.removeClass("ui-select ui-active"),-1!=n&&(o.eq(n).addClass("ui-select ui-active"),i.filterData=(i.dataModel.list[n]||{}).filter||{}),"object"===e.type(i.filterData)&&i.filter.attr("name",i.filterData.fieldName||"").val(i.filterData.attributeValue||""),i.selectedIndex=n},_action:function(i){var n=this;i.preventDefault(),"number"===e.type(n.filterData)?location.href=t.config.baseUrl+"?ObjectID="+n.filterData:n.elem.closest("form").trigger("submit")}}),i});
//@ sourceMappingURL=suggest.js.map